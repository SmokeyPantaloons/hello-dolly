<?php
/**
 * @package Hello_Towel
 * @version 1.6
 */
/*
Plugin Name: Hello Towel
Plugin URI: https://wordpress.org/plugins/hello-towel/
Description: Displays a line from Douglas Adams' books "The Hitchhiker's Guide to the Galaxy",
"The Long Dark Tea-Time of the Soul", and "The Salmon of Doubt", occasionally reminding us of 
the supreme value a towel can have.  Credit to Matt Mullenweg for original 'Hello Dolly' plugin. 
(Forked on Github @SmokeyPantaloons)
Author: Craig Dupuis
Version: 1
Author URI: https://www.cdupuis.com
Text Domain: hello-towel
*/

function hello_towel_get_line() {
	/** These are the lines from Douglas Adams */
$lines = ""A towel is about the most massively useful thing an interstellar hitchhiker can have.
Don't Panic.
Time is an illusion. Lunchtime doubly so.
Would it save you a lot of time if I just gave up and went mad now?
The ships hung in the sky in much the same way that bricks don't.
I'd far rather be happy than right any day.
If there's anything more important than my ego around, I want it caught and shot now.
For a moment, nothing happened. Then, after a second or so, nothing continued to happen.
So long, and thanks for all the fish.
We demand rigidly defined areas of doubt and uncertainty!
I think you ought to know I'm feeling very depressed.
The bird that would soar above the plain of tradition and prejudice must have strong wings.
The Ultimate Answer to Life, The Universe and Everything is...42!
Here, for whatever reason, is the world. And here it stays. With me on it.
I may not have gone where I intended to go, but I think I have ended up where I needed to be.
I love deadlines. I love the whooshing noise they make as they go by.
I'd far rather be happy than right any day.
You live and learn. At any rate, you live.
This must be Thursday.  I never could get the hang of Thursdays.
I don't go to mythical places with strange men.";

	// Here we split it into lines
	$lines = explode( "\n", $lines );

	// And then randomly choose a line
	return wptexturize( $lines[ mt_rand( 0, count( $lines ) - 1 ) ] );
}

// This just echoes the chosen line, we'll position it later
function hello_towel() {
	$chosen = hello_towel_get_line();
	echo "<p id='towel'>$chosen</p>";
}

// Now we set that function up to execute when the admin_notices action is called
add_action( 'admin_notices', 'hello_towel' );

// We need some CSS to position the paragraph
function towel_css() {
	// This makes sure that the positioning is also good for right-to-left languages
	$x = is_rtl() ? 'left' : 'right';

	echo "
	<style type='text/css'>
	#towel {
		float: $x;
		font-family: sans-serif;
		padding-$x: 15px;
		padding-top: 5px;
		margin: 0;
		font-size: 12px;
	}
	</style>
	";
}

add_action( 'admin_head', 'towel_css' );
